# Задача 1. Линейная алгебра

* **Дедлайн**: 25.02.2025, 23:59
* Максимум баллов: 10

---

## **Алгебраические структуры**

1. **Группы**  (1 балл)\
   **Задание**\
   Проверьте, является ли множество целых чисел $\mathbb{Z}$ с операцией сложения группой. Если да, является ли она абелевой? Ответ обоснуйте\
   **Решение**

Группа - множество с заданным на нем бинарной операцией $*$: $G \times G \rightarrow G$, если: 
 - Ассоциативность (Полугруппа)
 - Наличие нейтрального элемента (моноид $=$ полугруппа с единицей)
 - Наличие обратного элемента
      
Абелева группа - группа с коммутативностью.\
Для множества $\mathbb{Z}$ с операцией сложения выполняются все пункты для группы и для Абелевой группы: 
- Ассоциативность: $(3+4) + 5 = 3 + (4+5)$  
- Нейтральный элемент: $0$
- Обратный элемент: противоположный элемент (для $a$ это $-a$)
- Коммутативность: $x + y = y + x$

2. **Кольца и поля**  (1 балл)\
   **Задание**\
   Образует ли множество квадратных матриц размера $2 \times 2$ с операциями сложения и умножения кольцо? Является ли это кольцо полем? Ответ поясните.\
   **Ответ**\
Кольцо - множество $R$ с двумя бинарными операциями $+$ (сложение) и $\cdot$ (умножение), если:
- $(R, +)$ - абелева группа
- $(R, \cdot)$ - полугруппа (ассоциативность умножения)
- Дистрибутивность: $a \cdot (b + c) = a \cdot b + a \cdot c$ и $(a + b) \cdot c = a \cdot c + b \cdot c$

Поле - кольцо, в котором:
- $(R \setminus \{0\}, \cdot)$ - абелева группа (коммутативность и обратимость умножения)

Для множества квадратных матриц $2 \times 2$ с операциями сложения и умножения выполняются все свойства кольца:
- $(M_{2}, +)$ - абелева группа: ассоциативность, коммутативность, нейтральный элемент (нулевая матрица), обратный элемент $(-A)$
- $(M_{2}, \cdot)$ - полугруппа: ассоциативность умножения матриц
- Дистрибутивность: $A \cdot (B + C) = A \cdot B + A \cdot C$ и $(A + B) \cdot C = A \cdot C + B \cdot C$

Однако это кольцо не является полем, так как не все ненулевые матрицы обратимы. Например, матрица $\begin{pmatrix} 1 & 0 \\ 0 & 0 \end{pmatrix}$ не имеет обратной (её определитель равен $0$). 

3. **Полиномы как кольцо**  (1 балл)
   
   Проверьте, является ли множество полиномов степени не выше $2$ с коэффициентами из $\mathbb{R}$ и обычными операциями сложения и умножения кольцом. Укажите его свойства.\
   **Решение**

Множество полиномов степени не выше $2$ с коэффициентами из $\mathbb{R}$ **НЕ образует кольцо** относительно обычных операций сложения и умножения, так как нарушается **замкнутость относительно умножения**.

**Проверка свойств:**

- $(P_{2}, +)$ - абелева группа:
  - Ассоциативность: $(p(x) + q(x)) + r(x) = p(x) + (q(x) + r(x))$ 
  - Коммутативность: $p(x) + q(x) = q(x) + p(x)$ 
  - Нейтральный элемент: нулевой полином $0$ 
  - Обратный элемент: $-p(x)$ для каждого $p(x)$ 

- $(P_{2}, \cdot)$ - **НЕ является полугруппой**:
  - Ассоциативность умножения: выполняется 
  - **Замкнутость: НЕ выполняется** 
  
  **Контрпример:** Пусть $p(x) = x^2$ и $q(x) = x^2$ - оба полинома степени $\leq 2$.
  Тогда $p(x) \cdot q(x) = x^2 \cdot x^2 = x^4$ - полином степени 4, который **не принадлежит** $P_{2}$.

**Вывод:** Множество полиномов степени не выше $2$ не замкнуто относительно умножения, поэтому **не является кольцом**.

**Замечание:** Множество **всех** полиномов с коэффициентами из $\mathbb{R}$ (без ограничения степени) образует коммутативное кольцо с единицей $\mathbb{R}[x]$, которое не является полем

---

## **Операции с матрицами**

4. **Умножение матриц**  (1 балл)
   
   Даны матрицы:
   
   <img width="411" alt="Снимок экрана 2025-02-11 в 12 31 44" src="https://github.com/user-attachments/assets/0dd46597-cec3-4aeb-bb31-c2eabe1d4c77" />
   
   Вычислите $(A \cdot B) \cdot C$ и $A \cdot (B \cdot C)$. Сделайте вывод об ассоциативности умножения матриц.\
   **Решение**

Даны матрицы:
$A = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$, 
$B = \begin{pmatrix} 0 & -1 \\ 2 & 5 \end{pmatrix}$, 
$C = \begin{pmatrix} 2 & 0 \\ 1 & 3 \end{pmatrix}$

Вычислим $(A \cdot B) \cdot C$:

$A \cdot B = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix} \cdot \begin{pmatrix} 0 & -1 \\ 2 & 5 \end{pmatrix} = \begin{pmatrix} 1 \cdot 0 + 2 \cdot 2 & 1 \cdot (-1) + 2 \cdot 5 \\ 3 \cdot 0 + 4 \cdot 2 & 3 \cdot (-1) + 4 \cdot 5 \end{pmatrix} = \begin{pmatrix} 4 & 9 \\ 8 & 17 \end{pmatrix}$

$(A \cdot B) \cdot C = \begin{pmatrix} 4 & 9 \\ 8 & 17 \end{pmatrix} \cdot \begin{pmatrix} 2 & 0 \\ 1 & 3 \end{pmatrix} = \begin{pmatrix} 4 \cdot 2 + 9 \cdot 1 & 4 \cdot 0 + 9 \cdot 3 \\ 8 \cdot 2 + 17 \cdot 1 & 8 \cdot 0 + 17 \cdot 3 \end{pmatrix} = \begin{pmatrix} 17 & 27 \\ 33 & 51 \end{pmatrix}$

Вычислим $A \cdot (B \cdot C)$:

$B \cdot C = \begin{pmatrix} 0 & -1 \\ 2 & 5 \end{pmatrix} \cdot \begin{pmatrix} 2 & 0 \\ 1 & 3 \end{pmatrix} = \begin{pmatrix} 0 \cdot 2 + (-1) \cdot 1 & 0 \cdot 0 + (-1) \cdot 3 \\ 2 \cdot 2 + 5 \cdot 1 & 2 \cdot 0 + 5 \cdot 3 \end{pmatrix} = \begin{pmatrix} -1 & -3 \\ 9 & 15 \end{pmatrix}$

$A \cdot (B \cdot C) = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix} \cdot \begin{pmatrix} -1 & -3 \\ 9 & 15 \end{pmatrix} = \begin{pmatrix} 1 \cdot (-1) + 2 \cdot 9 & 1 \cdot (-3) + 2 \cdot 15 \\ 3 \cdot (-1) + 4 \cdot 9 & 3 \cdot (-3) + 4 \cdot 15 \end{pmatrix} = \begin{pmatrix} 17 & 27 \\ 33 & 51 \end{pmatrix}$

**Вывод:** $(A \cdot B) \cdot C = A \cdot (B \cdot C) = \begin{pmatrix} 17 & 27 \\ 33 & 51 \end{pmatrix}$. Умножение матриц ассоциативно.

5. **Умножение Кронекера**  (2 балла)
   
   Даны матрицы:
   
   <img width="272" alt="Снимок экрана 2025-02-11 в 12 33 44" src="https://github.com/user-attachments/assets/34f8387a-d1ae-433b-9056-add50e8abe75" />

   Вычислите произведение Кронекера этих двух матриц.\
   **Решение**

Даны матрицы:
$A = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$, 
$B = \begin{pmatrix} 0 & -1 \\ 2 & 5 \end{pmatrix}$

Произведение Кронекера $A \otimes B$ вычисляется по формуле:
$A \otimes B = \begin{pmatrix} a_{11}B & a_{12}B \\ a_{21}B & a_{22}B \end{pmatrix}$

Вычислим блоки:
- $a_{11}B = 1 \cdot B = \begin{pmatrix} 0 & -1 \\ 2 & 5 \end{pmatrix}$
- $a_{12}B = 2 \cdot B = \begin{pmatrix} 0 & -2 \\ 4 & 10 \end{pmatrix}$
- $a_{21}B = 3 \cdot B = \begin{pmatrix} 0 & -3 \\ 6 & 15 \end{pmatrix}$
- $a_{22}B = 4 \cdot B = \begin{pmatrix} 0 & -4 \\ 8 & 20 \end{pmatrix}$

Результат:
$A \otimes B = \begin{pmatrix} 
0 & -1 & 0 & -2 \\ 
2 & 5 & 4 & 10 \\ 
0 & -3 & 0 & -4 \\ 
6 & 15 & 8 & 20 
\end{pmatrix}$

---

## **Теория быстрого умножения матриц**

7. **Алгоритм Штрассена**  (1 балл)
   
   Умножьте матрицы методом Штрассена:

   <img width="258" alt="Снимок экрана 2025-02-11 в 12 46 41" src="https://github.com/user-attachments/assets/65697944-13fc-43ed-8595-9ed4d5af7e61" />
  
   Опишите шаги разбиения на блоки и промежуточные вычисления.\
   **Решение**

Даны матрицы:
$F = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$, 
$G = \begin{pmatrix} 5 & 6 \\ 7 & 8 \end{pmatrix}$

**Шаг 1: Разбиение на блоки**

Для матриц $2 \times 2$ блоки уже имеют размер $1 \times 1$:
$F = \begin{pmatrix} a & b \\ c & d \end{pmatrix} = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$
$G = \begin{pmatrix} e & f \\ g & h \end{pmatrix} = \begin{pmatrix} 5 & 6 \\ 7 & 8 \end{pmatrix}$

**Шаг 2: Вычисление промежуточных значений (7 умножений вместо 8)**

$P_{1} = a(f - h) = 1 \cdot (6 - 8) = -2$

$P_{2} = (a + b)h = (1 + 2) \cdot 8 = 24$

$P_{3} = (c + d)e = (3 + 4) \cdot 5 = 35$

$P_{4} = d(g - e) = 4 \cdot (7 - 5) = 8$

$P_{5} = (a + d)(e + h) = (1 + 4) \cdot (5 + 8) = 5 \cdot 13 = 65$

$P_{6} = (b - d)(g + h) = (2 - 4) \cdot (7 + 8) = (-2) \cdot 15 = -30$

$P_{7} = (a - c)(e + f) = (1 - 3) \cdot (5 + 6) = (-2) \cdot 11 = -22$

**Шаг 3: Вычисление элементов результирующей матрицы**

$R = F \cdot G = \begin{pmatrix} r_{11} & r_{12} \\ r_{21} & r_{22} \end{pmatrix}$

$r_{11} = P_{5} + P_{4} - P_{2} + P_{6} = 65 + 8 - 24 + (-30) = 19$

$r_{12} = P_{1} + P_{2} = -2 + 24 = 22$

$r_{21} = P_{3} + P_{4} = 35 + 8 = 43$

$r_{22} = P_{5} + P_{1} - P_{3} - P_{7} = 65 + (-2) - 35 - (-22) = 50$

**Результат:**
$F \cdot G = \begin{pmatrix} 19 & 22 \\ 43 & 50 \end{pmatrix}$

8. **Сравнение сложности**  (1 балл)
    
   Сравните количество арифметических операций для умножения матриц $4 \times 4$ стандартным методом и методом Штрассена. Приведите формулы расчёта.\
   **Решение**

**Стандартный метод умножения матриц:**

Для матриц размера $n \times n$:
- Количество умножений: $n^{3}$
- Количество сложений: $n^{2}(n-1)$
- Общее количество операций: $n^{3} + n^{2}(n-1) = 2n^{3} - n^{2}$

Для матриц $4 \times 4$:
- Умножений: $4^{3} = 64$
- Сложений: $4^{2} \cdot 3 = 48$
- Всего операций: $64 + 48 = 112$

**Метод Штрассена:**

Для матриц размера $n \times n$ сложность составляет $O(n^{\log_{2} 7}) \approx O(n^{2.807})$.

Для матриц $4 \times 4$ можно применить метод Штрассена рекурсивно:
- Разбиваем матрицу $4 \times 4$ на 4 блока $2 \times 2$
- Выполняем 7 умножений блоков $2 \times 2$
- Каждое умножение блоков $2 \times 2$ методом Штрассена требует 7 умножений скаляров
- Итого умножений: $7 \cdot 7 = 49$

**Подсчет сложений:**
- Верхний уровень (подготовка аргументов M1-M7): 10 операций с блоками $2 \times 2$ = $10 \cdot 4 = 40$ сложений
- Верхний уровень (комбинирование C11, C12, C21, C22): 8 операций с блоками $2 \times 2$ = $8 \cdot 4 = 32$ сложения
- Нижний уровень (7 умножений $2 \times 2$ методом Штрассена): $7 \cdot 18 = 126$ сложений
- Итого сложений: $40 + 32 + 126 = 198$

**Сравнение:**

| Метод | Умножений | Сложений | Всего операций |
|-------|-----------|----------|----------------|
| Стандартный | 64 | 48 | 112 |
| Штрассена | 49 | 198 | 247 |

**Вывод:** Для матриц $4 \times 4$ метод Штрассена требует меньше умножений ($49$ против $64$), но значительно больше сложений ($198$ против $48$) из-за дополнительных операций при вычислении промежуточных значений и рекурсивных вызовов. Общее количество операций больше ($247$ против $112$). Метод Штрассена становится эффективнее для больших матриц (обычно начиная с $64 \times 64$) благодаря асимптотической сложности $O(n^{2.807})$ против $O(n^{3})$.

9. **Быстрое возведение в степень**  (2 балла)
    
    Объясните какие свойства квадратных матриц и операций над ними позволяют применить алгоритм быстрого возведения в степень (exponentiation by squaring). Например, вместо
   вычисления $R = (((A \cdot A) \cdot A) \cdot A)$ использовать вычисления $T = A \cdot A$, $R = T \cdot T$ с меньшим количеством матричных умножений.\
   **Решение**

Алгоритм быстрого возведения в степень (exponentiation by squaring) позволяет вычислять $A^{n}$ за $O(\log n)$ умножений вместо $O(n)$.

**Свойства квадратных матриц, необходимые для применения алгоритма:**

1. **Ассоциативность умножения матриц:**
   $(A \cdot B) \cdot C = A \cdot (B \cdot C)$
   
   Это свойство позволяет перегруппировывать операции умножения. Например:
   - Вместо $A^{4} = (((A \cdot A) \cdot A) \cdot A)$ ($3$ умножения)
   - Можно вычислить $A^{2} = A \cdot A$, затем $A^{4} = A^{2} \cdot A^{2}$ ($2$ умножения)

2. **Замкнутость относительно умножения:**
   Произведение двух квадратных матриц размера $n \times n$ также является квадратной матрицей размера $n \times n$.
   
   Это гарантирует, что промежуточные результаты (например, $A^{2}$, $A^{4}$) остаются матрицами того же размера и могут быть использованы в дальнейших вычислениях.

3. **Существование единичной матрицы:**
   Для любой квадратной матрицы $A$ существует единичная матрица $I$ такая, что $A \cdot I = I \cdot A = A$.
   
   Это позволяет корректно обрабатывать случай $A^{0} = I$.

**Пример применения:**

Для вычисления $A^{8}$:
- Наивный метод: $A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A \cdot A$ ($7$ умножений)
- Метод быстрого возведения:
  - $A^{2} = A \cdot A$ ($1$ умножение)
  - $A^{4} = A^{2} \cdot A^{2}$ ($1$ умножение)
  - $A^{8} = A^{4} \cdot A^{4}$ ($1$ умножение)
  - Итого: $3$ умножения вместо $7$

**Алгоритм:**
- Если степень чётная: $A^{n} = (A^{n/2})^{2}$
- Если степень нечётная: $A^{n} = A \cdot A^{n-1}$

Благодаря ассоциативности умножения, мы можем безопасно перегруппировывать операции и использовать уже вычисленные степени матрицы.

---
